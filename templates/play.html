<div id="chat" class="chat-window"></div>
<input id="input" placeholder="Ask me anythingâ€¦" />
<button onclick="send()">Send</button>

<script>
  // initialize with an optional system message
  const messages = [
    { role: "system", content: "You are a helpful assistant." }
  ];

  function render() {
    const chat = document.getElementById("chat");
    chat.innerHTML = "";
    messages.forEach(m => {
      const div = document.createElement("div");
      div.className = "bubble " + (m.role === "user" ? "user" : "assistant");
      div.innerText = m.content;
      chat.append(div);
    });
    document.getElementById("input").value = "";
    chat.scrollTop = chat.scrollHeight;
  }

  async function send() {
    const txt = document.getElementById("input").value.trim();
    if (!txt) return;
    messages.push({ role: "user", content: txt });
    render();

    const res = await fetch("/api/play", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ messages })
    });
    const j = await res.json();
    messages.push({ role: "assistant", content: j.response });
    render();
  }

  // first render
  render();
</script>
